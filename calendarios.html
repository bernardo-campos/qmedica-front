<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">

  <script
    src="https://code.jquery.com/jquery-3.1.1.min.js"
    integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
    crossorigin="anonymous"></script>


  <style type="text/css">
    body {
      background-color: #FFFFFF;
    }
    .ui.menu .item img.logo {
      margin-right: 1.5em;
    }
    .main.container {
      margin-top: 7em;
    }

    /* Heading */
    .titulo {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
    }

    /* LIST */
    .ui.celled.list .item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      min-height: 2.5em;
    }
    .ui.list>.item:after {
      display: none;
    }
    .circular.icon.button {
      color: black!important;
      border: 1px solid rgba(34,36,38,.15);
      box-shadow: 0 1px 2px 0 rgba(34,36,38,.15);
    }
    .m-0-auto {
      margin: 0 auto;
    }
    </style>

  <title>Semantic UI example</title>
</head>
<body>
  <div class="ui fixed inverted menu">
    <div class="ui container">
      <a href="#" class="header item">
        <img class="logo" src="https://cdn4.iconfinder.com/data/icons/pretty-office-part-6-reflection-style/256/Status.png">
        QMedica
      </a>
      <a href="/qmedica-front" class="item">Turnos</a>
      <a href="#" class="item">Calendarios</a>
      <!-- <a href="#" class="item">Pacientes</a> -->
      <a href="login.html" class="item right floated">Cerrar sesión</a>
    </div>
  </div>

  <div class="ui main text container">

    <!-- Titulo -->
    <div class="titulo">
      <h1 class="ui header">Calendarios</h1>
      <button class="circular ui positive basic icon button" onclick="showAddCalendar()">
        <i class="icon plus"></i>
      </button>
    </div>

    <!-- Listado de turnos -->
    <div class="ui celled list">
      <div class="item">
        <div class="content">
          <div class="header">Nombre calendario 01</div>
        </div>
        <a href="calendario.html" class="ui basic icon button">
          <i class="pencil alternate icon"></i>
        </a>
      </div>
      <div class="item">
        <div class="content">
          <div class="header">Nombre calendario 02</div>
        </div>
        <a href="calendario.html" class="ui basic icon button">
          <i class="pencil alternate icon"></i>
        </a>
      </div>
      <div class="item">
        <div class="content">
          <div class="header">Nombre calendario 03</div>
        </div>
        <a href="calendario.html" class="ui basic icon button">
          <i class="pencil alternate icon"></i>
        </a>
      </div>
    </div>

  </div>
  <!-- .container -->

  <form class="ui tiny modal">
    <div class="header">Nuevo calendario</div>
    <div class="content">
      <div class="ui left icon input fluid">
        <input type="text" name="CalendarioNombre" id="CalendarioNombre" placeholder="Nombre del calendario">
        <i class="calendar alternate outline icon"></i>
      </div>
    </div>
    <div class="actions">
      <button type="button" class="ui button">Cancelar</button>
      <button type="submit" class="ui positive button">Crear</button>
    </div>
  </div>


<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
<script type="text/javascript">

  function showAddCalendar() {
    $('.tiny.modal')
      .modal({
        centered: true
      })
      .modal('show')
    ;
  }

  $('form').submit(function(event) {
    event.preventDefault();

    let list = $('.ui.celled.list');
    let CalendarioNombre = $('#CalendarioNombre').val();

    $(this).trigger('reset');

    let exito = Math.random() < 0.5;
    let time = 1000 + Math.floor(Math.random()*3000);

    let loader = $(`
      <div class="item">
        <div class="m-0-auto contenido">
          <div class="ui active centered inline loader"></div>
          <p>Cargando...</p>
        </div>
      </div>`);
    list.append(loader);

    console.log({time: time, CalendarioNombre: CalendarioNombre, success: exito});
    setTimeout(function () {
      if (exito) {
        let itemContent = `
          <div class="content">
            <div class="header">${CalendarioNombre}</div>
          </div>
          <a href="calendario.html" class="ui basic icon button">
            <i class="pencil alternate icon"></i>
          </a>`
        loader.html(itemContent);
      }
      else {
        itemError = `
          <div class="ui negative message" style="width: 100%;">
            <i class="close icon"></i>
            <div class="header">Ha ocurrido un error</div>
            <p>No se pudo agregar el calendario "${CalendarioNombre}". Por favor, inténtelo más tarde</p>
        </div>`;
        loader.html(itemError);
      }
    }, time);
  });
  /*<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< $('form').submit() */

 /* Cerrar mensajes de error */
  $(document).on('click', '.message .close', function() {
    $(this)
      .closest('.item')
      .fadeOut(300, function() {$(this).remove(); });
  });


  $(document).ready(function(){
    $('select.dropdown')
      .dropdown()
    ;

    myModal = $('.ui.modal')
      .modal({
        centered: false
      })
    ;

  $('.libre a').click(function (event) {
    event.preventDefault();
    myModal.modal('show');
  });

  })
</script>
</body>
</html>
